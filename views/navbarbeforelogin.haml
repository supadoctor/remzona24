.tm-navbar.uk-navbar.uk-navbar-attached{"data-uk-sticky"=>"", :style=>"z-index: 2; box-shadow: 0 5px 10px -5px rgba(0,0,0,0.5); border-top: none;"}
  .uk-container.uk-container-center
    %ul.uk-navbar-nav.uk-visible-large
      %li
        %a{:href=>"#register", "data-uk-modal" => "{bgclose:false}"}
          %button.uk-button.uk-button-mini.uk-button-success Регистрация
      %li
        %a{:href=>"#login", "data-uk-modal" => "{bgclose:false}"}
          %i.uk-icon-signin
          Войти в систему
      %li
        %a{:href=>"/", "data-uk-modal" => "{bgclose:false}"}
          %i.uk-icon-home
          Главная
    %ul.uk-navbar-nav.uk-navbar-flip
      .uk-navbar-content
        .uk-button-group
          %form.uk-form{:action => "/", :method => "post"}
            %input#areascope.uk-form-width-large.uk-form-small{:type=>"text", :name=>"areascope", :placeholder => session[:siteregionplaceholder]}
            %input#sitelocation{:type=>"text", :name=>"sitelocation", :hidden=>"true"}
            %input#sitearea{:type=>"text", :name=>"sitearea", :hidden=>"true"}
            %input#siteregion{:type=>"text", :name=>"siteregion", :hidden=>"true"}
            %button.uk-button.uk-button-mini.uk-button-primary{:type=>"submit", :style=>"margin-left: 5px;"} Изменить
#register.uk-modal
  .uk-modal-dialog.uk-modal-dialog-slide
    %a.uk-modal-close.uk-close
    %h1 Регистрация
    %ul.uk-tab.uk-tab-grid.data-uk-tab{"data-uk-tab"=>"{connect:'#typesofuser'}"}
      %li.uk-width-1-3.uk-active
        %a{:href=>""}Пользователь
      %li.uk-width-1-3
        %a{:href=>""}Мастер
      %li.uk-width-1-3
        %a{:href=>""}Сервис
    %ul#typesofuser.uk-switcher.uk-margin
      %li
        %form.uk-form{:action => "/reguser", :method => "post"}
          %legend
            Вы регистрируетесь с целью добавления заказов, ведения переписки с мастерами и сервисными центрами
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Адрес электронной почты", :name=>"email"}
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Контактное лицо", :name=>"fullname"}
          .uk-form-row
            %input#userlocation.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Населенный пункт", :style=>"z-index=9999;"}
            %input#userlocationtitle{:type=>"text", :name=>"locationtitle", :hidden=>"true"}
            %input#userarea{:type=>"text", :name=>"area", :hidden=>"true"}
            %input#userregion{:type=>"text", :name=>"region", :hidden=>"true"}
          .uk-form-row
            %input#pass1.uk-width-1-1{:type=>"password", :required=>"", :placeholder=>"Пароль", :name=>"password"}
          .uk-form-row
            %input#pass2.uk-width-1-1{:type=>"password", :required=>"", :placeholder=>"Подтверждение пароля", :name=>"pass"}
          .uk-form-row
            %label
              %input.userrules{:type=>"checkbox"}
              Я принимаю правила использования портала РемЗона24.ру
          %br
          %button#usersubmit.uk-button.uk-button-primary.uk-align-center{:type=>"submit", :disabled => ""}Регистрация
      %li
        %form.uk-form{:action => "/regmaster", :method => "post"}
          %legend
            Вы являетесь индивидуальным предпринимателем, бригадой или небольшой фирмой и оказываете услуги по ремонту автомобилей, работая напрямую с заказчиком.
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Адрес электронной почты", :name=>"email"}
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Фамилия", :name=>"familyname"}
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Имя", :name=>"name"}
          .uk-form-row
            %input.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Отчество", :name=>"fathersname"}
          .uk-form-row
            %textarea#subject{:type=>"text", :placeholder=>"Описание деятельности", :name=>"description", :cols=>"100%", :rows=>"4"}
          .uk-form-row
            %textarea#tags{:type=>"text", :name=>"tags", :cols=>"100%", :rows=>"1"}
          .uk-form-row
            %input#masterlocation.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Населенный пункт", :style=>"z-index=9999;"}
            %input#masterlocationtitle{:type=>"text", :name=>"locationtitle", :hidden=>"false"}
            %input#masterarea{:type=>"text", :name=>"area", :hidden=>"false"}
            %input#masterregion{:type=>"text", :name=>"region", :hidden=>"false"}
          .uk-form-row
            %input#pass1.uk-width-1-1{:type=>"text", :required=>"", :placeholder=>"Адрес Вашей страницы (вида ВАШАСТРАНИЦА.remzona24.ru)", :name=>"domain"}
          .uk-form-row
            %input#pass1.uk-width-1-1{:type=>"password", :required=>"", :placeholder=>"Пароль", :name=>"password"}
          .uk-form-row
            %input#pass2.uk-width-1-1{:type=>"password", :required=>"", :placeholder=>"Подтверждение пароля", :name=>"pass"}
          .uk-form-row
            %label
              %input.masterrules{:type=>"checkbox"}
              Я принимаю правила использования портала РемЗона24.ру
          %br
          %button#mastersubmit.uk-button.uk-button-primary.uk-align-center{:type=>"submit", :disabled => ""}Регистрация
      %li
        %form.uk-form
          %fieldset
            %legend
              Вы представляете компанию, которая предоставляет услуги в сфере ремонта и обслуживания автомобилей и хотели бы продавать свои услуги через портал РемЗона24.ру
#login.uk-modal
  .uk-modal-dialog.uk-modal-dialog-slide
    %a.uk-modal-close.uk-close
    %h1 Вход
    %form.uk-form{:action => "/auth/login", :method=>"post"}
      %fieldset
        %legend
          Для входа в систему введите, пожалуйста, адрес электронной почты, указанной при регистрации, и пароль
        .uk-form-row
          %input.uk-width-1-1{:type=>"email", :required=>"", :placeholder=>"Адрес электронной почты", :name=>"email"}
        .uk-form-row
          %input.uk-width-1-1{:type=>"password", :required=>"", :placeholder=>"Пароль", :name=>"password"}
        %br
        %button#submit.uk-button.uk-button-primary.uk-align-center{:type=>"submit"}Вход

=yield

:javascript
  $(function() {

    var userregionselected = false;
    var masterregionselected = false;

    $('.userrules').change(function() {
      if(this.checked & userregionselected){
        $('#usersubmit').removeAttr("disabled");
      } else {
        $('#usersubmit').attr("disabled","");
      }
    });

    $('.masterrules').change(function() {
      if(this.checked & masterregionselected){
        $('#mastersubmit').removeAttr("disabled");
      } else {
        $('#mastersubmit').attr("disabled","");
      }
    });

    $('#userlocation').autocomplete({
      source: function( request, response ) {
        $.ajax({
          url: "http://api.vk.com/method/database.getCities?v=5&country_id=1",
          dataType: "jsonp",
          data: {
            q: request.term
          },
          success: function( data ) {
            response( $.map( data.response.items, function( item ) {
              return {
                label: item.title + (item.area ? ", " + item.area : "") + (item.region ? ", " + item.region : ""),
                value: item.title + (item.area ? ", " + item.area : "") + (item.region ? ", " + item.region : ""),
                title: item.title,
                area: item.area ? item.area : "",
                region: item.region ? item.region : ""
              }
            }))
          }
        });
      },
      minLength: 2,
      select: function (event, ui) {
        $('#userlocationtitle').val(ui.item.title);
        $('#userarea').val(ui.item.area);
        $('#userregion').val(ui.item.region);
        userregionselected = true;
      }
    });

    $('#masterlocation').autocomplete({
      source: function( request, response ) {
        $.ajax({
          url: "http://api.vk.com/method/database.getCities?v=5&country_id=1",
          dataType: "jsonp",
          data: {
            q: request.term
          },
          success: function( data ) {
            response( $.map( data.response.items, function( item ) {
              return {
                label: item.title + (item.area ? ", " + item.area : "") + (item.region ? ", " + item.region : ""),
                value: item.title + (item.area ? ", " + item.area : "") + (item.region ? ", " + item.region : ""),
                title: item.title,
                area: item.area ? item.area : "",
                region: item.region ? item.region : ""
              }
            }))
          }
        });
      },
      minLength: 2,
      select: function (event, ui) {
        $('#masterlocationtitle').val(ui.item.title);
        $('#masterarea').val(ui.item.area);
        $('#masterregion').val(ui.item.region);
        masterregionselected = true;
      }
    });

    /***************/

    $('#tags').selectize({
      valueField: 'tag',
      labelField: 'tag',
      searchField: 'tag',
      plugins: ['remove_button'],
      delimiter: ',',
      persist: false,
      create: function(input) {
        return {
          tag: input
        }
      },
      render: {
        option: function(data, escape) {
          return '<div>"' + escape(data.tag) + '"</div>';
        }
      },
      load: function(query, callback) {
        if (!query.length) return callback();
        $.ajax({
          url : '/ajax/tags.json',
          dataType : 'json',
          success: function(res) {
            callback(res.tags);
          }
        });
      }
    });

    /***************/

  });